<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="spring.model.mapper.reviewMapper">

	<select id="list" resultType="reviewDTO">
		select no, id, itemNo, itemOption, content, picture,itemPicture,
		itemTitle, cm, kg, mysize
		from(
		select r.no as no, r.id as id, r.itemNo as itemNo, r.itemOption as
		itemOption,
		r.content as content, r.picture as picture,i.image as itemPicture,i.title as
		itemTitle, r.cm as cm, r.kg as kg, r.mysize as mysize,rownum rnum
		from item i, review r
		where r.itemNo = i.no)
<![CDATA[ where rnum>=#{sno} and rnum<=#{eno}]]>
	</select>

	<select id="read" parameterType="int" resultType="reviewDTO">
		select r.no as
		no, r.id as id, r.itemNo as itemNo, r.itemOption as itemOption,
		r.content as content, r.picture as picture,
		i.image as itemPicture,i.title as itemTitle, r.cm as cm, r.kg as kg, r.mysize
		as mysize
		from item i, review r
		where r.itemNo = r.itemNo
	</select>

	<select id="pcount" resultType="int">
		select count(*) as pcount
		from review
		where picture is not null
	</select>

	<select id="total" parameterType="Map" resultType="int">
		select count(*) from review
		<where>
			<choose>
				<when test="col=='content'">
					content like '%'||#{word}||'%'
				</when>
				<when test="col=='title'">
					title like '%'||#{word}||'%'
				</when>
				<when test="col=='id'">
					id like '%'||#{word}||'%'
				</when>
			</choose>
		</where>
	</select>
</mapper>