<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="spring.model.mapper.OrderMapper">


	<select id="checkItem" parameterType="List"
		resultType="OrderItemDTO">
		select itemOptionNo,itemCount,price as itemPrice,salePrice as
		itemSalePrice
		from itemOption o, item i
		where o.itemNo = i.itemNo and itemOptionNo in
		<foreach item="item" collection="list" open="(" separator=","
			close=")">
			#{item.itemOptionNo,jdbcType=INTEGER}
		</foreach>
		order by itemOptionNo
	</select>

	<insert id="insert" parameterType="OrderDTO"
		useGeneratedKeys="true" keyProperty="orderNo" keyColumn="orderNo">
		insert into norder(orderno,odate,id,salePrice,rname,postcode,address,detailaddress,rphone,remail,rmsg,paymenttype,imagineaccount,imaginebank,imaginedate,state)
	values(#{orderNo}||'-'||lpad(orderNo_SEQ.nextval,8,'0'),sysdate,#{id},#{salePrice},#{rname},#{postcode},#{address},#{detailaddress},
	#{rphone},#{remail,jdbcType=VARCHAR},#{rmsg,jdbcType=VARCHAR},#{paymentType,jdbcType=VARCHAR},#{imagineAccount,jdbcType=VARCHAR},#{imagineBank,jdbcType=VARCHAR},#{imagineDate,jdbcType=VARCHAR},#{state})
	</insert>
	
	<delete id="delete" parameterType="String">
		delete from norder
		where orderNo = #{orderNo}
	</delete>

</mapper>